# MKG-app 開発ガイドライン

## 📊 記憶媒体・データ管理方針

### 🎯 基本方針
**LocalStorageを使用しない - 全てSupabaseで管理**

### 🔍 理由・背景
- **デバイス依存性の回避**: PC・スマホ・タブレット間でデータ同期
- **運用リスク軽減**: 各デバイス固有の記憶域に依存すると重複・不整合が発生
- **本格運用対応**: 企業運用では複数デバイスからのアクセスが前提

### ✅ 実装原則
1. **全データをSupabaseに保存**
   - ユーザー認証情報
   - チーム別改善番号管理
   - カイゼン展開表
   - 活動報告書データ

2. **データ整合性の確保**
   - 重複番号の防止（team_numbersテーブルでUNIQUE制約）
   - 楽観的ロック・バージョン管理の実装

3. **エラーハンドリング**
   - ネットワーク接続エラー時の適切な通知
   - データ保存失敗時の再試行機能

### 🚫 禁止事項
- LocalStorage、SessionStorageの使用
- ブラウザ依存のデータ保存
- 一時的な迂回措置（本格運用に影響するもの）

### 🔧 技術実装
- **データベース**: Supabase PostgreSQL
- **認証**: Supabase Auth + RLS（Row Level Security）
- **リアルタイム同期**: Supabase Realtime（必要に応じて）

---

## 🏗️ 開発・実装方針

### 📏 品質基準
1. **ユーザーテスト前の徹底検証**
   - プログラム上でのエラー排除
   - 本格運用を念頭に置いた動作確認

2. **迂回・回避の禁止**
   - 根本的解決の徹底
   - 場当たり的な対応の排除

3. **完全実装主義**
   - 中途半端な確認ではなく完全な機能実装
   - テスト段階での妥協なし

### 🎯 認証・セキュリティ
- **Supabase認証基盤の活用**
- **適切なRLS政策の実装**
- **チーム選択機能の維持**（複数チーム所属者対応）

---

## 📝 更新履歴

### 2025-09-15
- **記憶媒体方針を明確化**: LocalStorage完全廃止、Supabase一元管理
- **改善番号管理をSupabase対応**: team_numbersテーブルによる一元管理
- **デバイス間同期の実現**: 番号体系の統一

---

*このファイルは開発方針の重要な決定事項を記録し、全ての開発者が参照すべき基準を示しています。*
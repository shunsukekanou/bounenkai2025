# MKGアプリ 修正・改善タスクリスト

## 完了済み ✅

### 1. タスクが消える症状の修正 ✅
- [x] 他のブラウザに切り替えただけでも消える
- [x] ログイン・ログアウトでも消える
- [x] 別のアカウント切り替え時も消える
- **修正内容**:
  - タスク作成時にSupabase tasksテーブルに保存
  - チーム選択時・タブ復帰時・メイン画面表示時にタスクをロード
  - タスク開始・戻す操作時にSupabaseに保存
- **コミット**: 82387d2

### 2. 初回のカイゼンナンバー入力画面から先に進めない問題 ✅
- [x] 正しくナンバー入力しても次の活動報告書作成の工程に進めない
- **修正内容**:
  - カイゼンナンバー設定後にloadTasksFromSupabaseでタスク再ロード
  - 最新データで報告書作成画面に遷移
- **コミット**: e938f3e

### 閲覧ボタンの追加 ✅
- [x] 報告書一覧カードに「閲覧」ボタンを追加
- [x] ✕（削除）ボタンの左に5mm間隔で配置
- **修正内容**:
  - 報告書一覧カードの右上に閲覧ボタン追加
  - 読み取り専用モードで報告書内容を表示
- **コミット**: de723f5

### 3. 進行中枠のタスクのボタン配置を変更 ✅
- [x] 左から「戻る」「編集」「削除」の順に並べ替え
- [x] 各ボタンの間隔を5mm空けて配置
- [x] カレンダー表示ボタンを進行中枠の右上に設置し名前を「期間設定」に変更
- **修正内容**:
  - ボタン順序変更: 戻る→編集→削除
  - ボタン間隔を5mmに設定
  - 進行中枠右上に「📅 期間設定」ボタン追加
  - updateTaskDates関数をSupabase対応に修正
  - getTasksForDate関数でteam_id/teamId両方をチェック
- **コミット**: 80b3c9a

### 4. パトロールチェックシートの入力ルール変更 ✅
- [x] 「被監査チームと日付」を「監査チームと日付」に変更
- **修正内容**:
  - エラーメッセージを「監査チーム名と監査日は必須です」に変更
- **コミット**: 4f24c05

### 5. タスクの開始ボタンから開く期間設定画面の改善 ✅
- [x] 年月日入力欄のカレンダーボタンを左端に設置
- [x] 「カレンダーから設定」の名前の横長ボタンに変更
- **修正内容**:
  - 開始日・終了日の左側に「📅 カレンダーから設定」ボタンを配置
  - ボタンクリックで標準カレンダー（date picker）を開く
  - 元の日付入力欄のカレンダーアイコンを非表示
- **コミット**: 02dadd7

### 6. カイゼン展開表作成画面のキャンセルボタン追加 ✅
- [x] キャンセルボタンを右上にも配置
- **修正内容**:
  - カイゼン展開表作成モーダルの右上に「✕」ボタンを追加
  - クリックでモーダルを閉じる
- **コミット**: 748119f

### 7. パトロールチェックシート - 承認者・担当者表示改善 ✅
- [x] 承認者や担当者という表示を入力欄の上にも表示
- [x] 入力した文字で隠れないようにする
- **修正内容**:
  - 承認者・担当者のラベルを入力欄の左側に「承認者：」「担当者：」と表記
  - 入力欄の幅を150pxに設定（最大15文字入力可能）
  - 被監査と監査セクションを完全に横並び1行に配置
  - チーム選択の幅も150pxに縮小してバランス調整
- **コミット**: 04b25e6

### 8. パトロールチェックシート - 時間入力方法変更 ✅
- [x] 時間入力は手入力のみに変更
- [x] 時刻ピッカーを削除
- **修正内容**:
  - 時間入力をtype="time"からtype="text"に変更
  - プレースホルダー "00:00" を追加
  - 手入力時の時間計算ロジックを実装（HH:mm と H:mm 両方の形式に対応）
  - 全角コロン（：）を半角（:）に正規化する処理を追加
  - 所要時間の表示ロジックを修正（NaN問題を解決）
- **コミット**: 179ddaf

### 9. パトロールチェックシート - 前回点数入力欄の改善 ✅
- [x] 前回点数入力欄の数字を上げ下げするボタンを破棄
- [x] 手入力のみに変更
- **修正内容**:
  - 前回点数入力欄をtype="number"からtype="text"に変更
  - 数字の上げ下げボタンを削除
- **コミット**: ae8ecd0

### 10. ISO9001 規格要求事項 監査欄 - コピー機能 ✅
- [x] ISO9001 規格要求事項 監査欄の中の内容のみをコピー可能に
- [x] エクセルなどにそのままの見た目で貼り付けられるようにする
- **修正内容**:
  - html2canvasライブラリをインストール
  - ISO監査欄の紫枠にrefを追加
  - 画像コピーボタン「📋 コピー」を追加
  - クリップボードAPIで画像をコピー
- **コミット**: 125c913

### 11. パトロールチェックシート一覧 - ボタン名変更 ✅
- [x] カードの「内容確認」ボタンの名前を「閲覧」に変更
- **修正内容**:
  - ボタンテキストを「内容確認」→「閲覧」に変更
- **コミット**: 125c913

### 13. パトロールチェックシートタブ名変更 ✅
- [x] タブの名前を「パトロールチェックシート作成」に変更
- **修正内容**:
  - タブテキストを「✅ パトロールチェックシート」→「✅ パトロールチェックシート作成」に変更
- **コミット**: 125c913

### 14. 報告書一覧とパトロールチェックシート一覧の名称変更 ✅
- [x] 「報告書一覧」→「報告書一覧表」
- [x] 「パトロールチェックシート一覧」→「パトロールチェックシート一覧表」
- **修正内容**:
  - タブとh2タイトルの名称を変更
  - 「📊 報告書一覧」→「📊 報告書一覧表」
  - 「📋 パトロールチェックシート一覧」→「📋 パトロールチェックシート一覧表」
- **コミット**: 125c913

---

## 未着手・保留 ⏳

### 12. パトロールチェックシート - キーボード操作対応（保留）
- [ ] 記入欄へのカーソル移動を矢印キーでも可能にする
- [ ] 現在はマウスのみ対応
- **状態**: 実装後、ユーザー要望により元に戻して保留

---

## 作業メモ

**最終更新**: 2025-01-15
**現在の作業**: 全タスク完了（修正12は保留）
**完了タスク**: 修正1〜11, 13, 14 完了

**Git状態**:
- ブランチ: main
- 最新コミット: 125c913
- 未コミット変更: task-list.md（作業メモ更新）
